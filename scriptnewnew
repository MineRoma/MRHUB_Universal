local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Ñ–ª–∞—è
local FLYING = false
local QEfly = true
local flyKeyDown, flyKeyUp

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è Fly Fling
local flyFlingEnabled = false
local flyFlingConnection = nil
local lastFlingTime = {}

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è WalkSpeed –∏ JumpPower
local currentWalkSpeed = 16
local originalWalkSpeed = 16
local currentJumpPower = 50
local originalJumpPower = 50

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è WalkFling
local walkFlingEnabled = false
local walkFlingConnection = nil

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
local IgnoredPlayers = {}
local Noclip = false
local FlySpeed = 1
local originalFlingPosition = nil
local isFlinging = false
local selectedPlayerForTP = nil
local isMinimized = false

-- –ù–û–í–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è WalkSpeed
local walkSpeedEnforcerConnection = nil

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–π —á–∞—Å—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
local function getRoot(char)
    local root = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
    return root
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Humanoid
local function getHumanoid(char)
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    return humanoid
end

-- –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å WalkSpeed
local function updateWalkSpeed()
    if player.Character then
        local humanoid = getHumanoid(player.Character)
        if humanoid then
            -- 1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∂–µ–ª–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            humanoid.WalkSpeed = currentWalkSpeed

            -- 2. –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å–∫–æ—Ä–æ—Å—Ç–∏, –µ—Å–ª–∏ –æ–Ω –±—ã–ª
            if walkSpeedEnforcerConnection then
                walkSpeedEnforcerConnection:Disconnect()
                walkSpeedEnforcerConnection = nil
            end

            -- 3. –ù–û–í–´–ô –ù–ê–î–ï–ñ–ù–´–ô –ö–û–ù–¢–†–û–õ–õ–ï–†: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ WalkSpeed
            -- –ò—Å–ø–æ–ª—å–∑—É–µ–º GetPropertyChangedSignal, —á—Ç–æ–±—ã —Å–ª—É—à–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
            walkSpeedEnforcerConnection = humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
                -- –ï—Å–ª–∏ WalkSpeed –∏–∑–º–µ–Ω–∏–ª—Å—è –∏ –Ω–µ —Ä–∞–≤–µ–Ω –Ω–∞—à–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ
                if humanoid.WalkSpeed ~= currentWalkSpeed and currentWalkSpeed ~= 0 then
                    humanoid.WalkSpeed = currentWalkSpeed
                    -- print("‚ö†Ô∏è WalkSpeed –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω —Å–µ—Ä–≤–µ—Ä–æ–º/—Å–∫—Ä–∏–ø—Ç–æ–º. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤: " .. currentWalkSpeed)
                end
            end)
        end
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è JumpPower
local function updateJumpPower()
    if player.Character then
        local humanoid = getHumanoid(player.Character)
        if humanoid then
            humanoid.JumpPower = currentJumpPower
        end
    end
end

-- –°–æ–∑–¥–∞–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "XenoScriptGUI"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 750)
MainFrame.Active = true
MainFrame.Draggable = true

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞
local MainFrameCorner = Instance.new("UICorner")
MainFrameCorner.CornerRadius = UDim.new(0, 12)
MainFrameCorner.Parent = MainFrame

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Font = Enum.Font.GothamBold
Title.Text = "XENO SCRIPT"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.TextXAlignment = Enum.TextXAlignment.Center

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = Title

-- –ö–Ω–æ–ø–∫–∞ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = Title
MinimizeButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
MinimizeButton.BorderSizePixel = 0
MinimizeButton.Position = UDim2.new(0.9, 0, 0.15, 0)
MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Text = "-"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 16

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è
local MinimizeCorner = Instance.new("UICorner")
MinimizeCorner.CornerRadius = UDim.new(0, 6)
MinimizeCorner.Parent = MinimizeButton

-- –ü–æ–ª–µ –≤–≤–æ–¥–∞
local InputFrame = Instance.new("Frame")
InputFrame.Name = "InputFrame"
InputFrame.Parent = MainFrame
InputFrame.BackgroundTransparency = 1
InputFrame.Position = UDim2.new(0, 15, 0, 50)
InputFrame.Size = UDim2.new(1, -30, 0, 35)

local InputBox = Instance.new("TextBox")
InputBox.Name = "InputBox"
InputBox.Parent = InputFrame
InputBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
InputBox.BorderSizePixel = 0
InputBox.Position = UDim2.new(0, 0, 0, 0)
InputBox.Size = UDim2.new(0.7, 0, 1, 0)
InputBox.Font = Enum.Font.Gotham
InputBox.PlaceholderText = "–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫..."
InputBox.Text = ""
InputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
InputBox.TextSize = 14
InputBox.TextXAlignment = Enum.TextXAlignment.Left

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—è –≤–≤–æ–¥–∞
local InputBoxCorner = Instance.new("UICorner")
InputBoxCorner.CornerRadius = UDim.new(0, 8)
InputBoxCorner.Parent = InputBox

local AddButton = Instance.new("TextButton")
AddButton.Name = "AddButton"
AddButton.Parent = InputFrame
AddButton.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
AddButton.BorderSizePixel = 0
AddButton.Position = UDim2.new(0.72, 5, 0, 0)
AddButton.Size = UDim2.new(0.28, 0, 1, 0)
AddButton.Font = Enum.Font.GothamBold
AddButton.Text = "–î–û–ë–ê–í–ò–¢–¨"
AddButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AddButton.TextSize = 12

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
local AddButtonCorner = Instance.new("UICorner")
AddButtonCorner.CornerRadius = UDim.new(0, 8)
AddButtonCorner.Parent = AddButton

-- –°–ø–∏—Å–æ–∫ –∏–≥–Ω–æ—Ä–∞
local IgnoreLabel = Instance.new("TextLabel")
IgnoreLabel.Name = "IgnoreLabel"
IgnoreLabel.Parent = MainFrame
IgnoreLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
IgnoreLabel.Position = UDim2.new(0, 15, 0, 95)
IgnoreLabel.Size = UDim2.new(1, -30, 0, 25)
IgnoreLabel.Font = Enum.Font.Gotham
IgnoreLabel.Text = "–ò–≥–Ω–æ—Ä-–ª–∏—Å—Ç:"
IgnoreLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
IgnoreLabel.TextSize = 14
IgnoreLabel.TextXAlignment = Enum.TextXAlignment.Left

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–≥–Ω–æ—Ä-–ª–∏—Å—Ç–∞
local IgnoreLabelCorner = Instance.new("UICorner")
IgnoreLabelCorner.CornerRadius = UDim.new(0, 6)
IgnoreLabelCorner.Parent = IgnoreLabel

local IgnoreList = Instance.new("ScrollingFrame")
IgnoreList.Name = "IgnoreList"
IgnoreList.Parent = MainFrame
IgnoreList.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
IgnoreList.BorderSizePixel = 0
IgnoreList.Position = UDim2.new(0, 15, 0, 120)
IgnoreList.Size = UDim2.new(1, -30, 0, 80)
IgnoreList.CanvasSize = UDim2.new(0, 0, 0, 0)
IgnoreList.ScrollBarThickness = 5

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è —Å–ø–∏—Å–∫–∞ –∏–≥–Ω–æ—Ä–∞
local IgnoreListCorner = Instance.new("UICorner")
IgnoreListCorner.CornerRadius = UDim.new(0, 6)
IgnoreListCorner.Parent = IgnoreList

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Parent = IgnoreList
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫
local function CreateButton(text, color, yPosition)
    local button = Instance.new("TextButton")
    button.Parent = MainFrame
    button.BackgroundColor3 = color
    button.BorderSizePixel = 0
    button.Position = UDim2.new(0, 15, 0, yPosition)
    button.Size = UDim2.new(1, -30, 0, 35)
    button.Font = Enum.Font.GothamBold
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 14
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = button
    
    return button
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤
local function CreateControlFrame(labelText, yPosition)
    local frame = Instance.new("Frame")
    frame.Name = "ControlFrame"
    frame.Parent = MainFrame
    frame.BackgroundTransparency = 1
    frame.Position = UDim2.new(0, 15, 0, yPosition)
    frame.Size = UDim2.new(1, -30, 0, 30)

    local label = Instance.new("TextLabel")
    label.Name = "Label"
    label.Parent = frame
    label.BackgroundTransparency = 1
    label.Size = UDim2.new(0.5, 0, 1, 0)
    label.Font = Enum.Font.Gotham
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(200, 200, 200)
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left

    local downButton = Instance.new("TextButton")
    downButton.Name = "DownButton"
    downButton.Parent = frame
    downButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
    downButton.BorderSizePixel = 0
    downButton.Position = UDim2.new(0.5, 5, 0.2, 0)
    downButton.Size = UDim2.new(0.14, 0, 0.6, 0)
    downButton.Font = Enum.Font.GothamBold
    downButton.Text = "-"
    downButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    downButton.TextSize = 16

    local downCorner = Instance.new("UICorner")
    downCorner.CornerRadius = UDim.new(0, 4)
    downCorner.Parent = downButton

    local upButton = Instance.new("TextButton")
    upButton.Name = "UpButton"
    upButton.Parent = frame
    upButton.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
    upButton.BorderSizePixel = 0
    upButton.Position = UDim2.new(0.65, 5, 0.2, 0)
    upButton.Size = UDim2.new(0.14, 0, 0.6, 0)
    upButton.Font = Enum.Font.GothamBold
    upButton.Text = "+"
    upButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    upButton.TextSize = 16

    local upCorner = Instance.new("UICorner")
    upCorner.CornerRadius = UDim.new(0, 4)
    upCorner.Parent = upButton
    
    return frame
end

-- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏
local buttonY = 210
local buttonHeight = 35
local buttonSpacing = 5

local FlingButton = CreateButton("–§–õ–ò–ù–ì –í–°–ï–•", Color3.fromRGB(255, 50, 50), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local FlyButton = CreateButton("–ü–û–õ–ï–¢: –í–´–ö–õ", Color3.fromRGB(0, 150, 50), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local NoclipButton = CreateButton("–ù–û–£–ö–õ–ò–ü: –í–´–ö–õ", Color3.fromRGB(150, 150, 0), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local FlyFlingButton = CreateButton("FLY FLING: –í–´–ö–õ", Color3.fromRGB(150, 0, 150), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local WalkFlingButton = CreateButton("WALK FLING: –í–´–ö–õ", Color3.fromRGB(200, 100, 0), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local TPForwardButton = CreateButton("TP FORWARD", Color3.fromRGB(0, 100, 200), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local TPToPlayerButton = CreateButton("TP TO PLAYER", Color3.fromRGB(0, 150, 150), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local ResetButton = CreateButton("RESET", Color3.fromRGB(200, 0, 0), buttonY)
buttonY = buttonY + buttonHeight + buttonSpacing

local ServerHopButton = CreateButton("SERVER HOP", Color3.fromRGB(0, 150, 100), buttonY)

-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è TP
local PlayerListFrame = Instance.new("ScrollingFrame")
PlayerListFrame.Name = "PlayerListFrame"
PlayerListFrame.Parent = MainFrame
PlayerListFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
PlayerListFrame.BorderSizePixel = 0
PlayerListFrame.Position = UDim2.new(0, 15, 0, 525)
PlayerListFrame.Size = UDim2.new(1, -30, 0, 80)
PlayerListFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
PlayerListFrame.ScrollBarThickness = 5
PlayerListFrame.Visible = false

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
local PlayerListCorner = Instance.new("UICorner")
PlayerListCorner.CornerRadius = UDim.new(0, 6)
PlayerListCorner.Parent = PlayerListFrame

local PlayerListLayout = Instance.new("UIListLayout")
PlayerListLayout.Parent = PlayerListFrame
PlayerListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ–ª–µ—Ç–∞
local SpeedFrame = CreateControlFrame("Fly Speed: 1", 615)
local WalkSpeedFrame = CreateControlFrame("WalkSpeed: " .. currentWalkSpeed, 645)
local JumpPowerFrame = CreateControlFrame("JumpPower: " .. currentJumpPower, 675)

-- –§—É–Ω–∫—Ü–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞ –≤–ø–µ—Ä–µ–¥
local function TPForward()
    if not player.Character then return end
    
    local rootPart = getRoot(player.Character)
    if not rootPart then return end
    
    local camera = workspace.CurrentCamera
    local lookVector = camera.CFrame.LookVector
   
    -- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑–≥–ª—è–¥–∞
    local horizontalLook = Vector3.new(lookVector.X, 0, lookVector.Z).Unit
    
    -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞ 40 studs –≤–ø–µ—Ä–µ–¥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
    local newPosition = rootPart.Position + (horizontalLook * 40)
    
    -- –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –≤—ã—Å–æ—Ç—É, —á—Ç–æ–±—ã –Ω–µ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤–Ω–∏–∑
    newPosition = Vector3.new(newPosition.X, rootPart.Position.Y, newPosition.Z)
    
    -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é, —Å–æ—Ö—Ä–∞–Ω—è—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é
    rootPart.CFrame = CFrame.new(newPosition) * (rootPart.CFrame - rootPart.CFrame.Position)
end

-- –§—É–Ω–∫—Ü–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞ –∫ –∏–≥—Ä–æ–∫—É
local function TPToPlayer()
   
    if not selectedPlayerForTP then
        print("‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –≤—ã–±—Ä–∞–Ω!")
        return
    end
    
    if not player.Character then return end
    
    local targetPlayer = selectedPlayerForTP
    if not targetPlayer or not targetPlayer.Character then
        print("‚ùå –£ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞!")
        return
    end
    
    local targetRoot = getRoot(targetPlayer.Character)
   
    local myRoot = getRoot(player.Character)
    
    if not targetRoot or not myRoot then return end
    
    -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º—Å—è –∫ –∏–≥—Ä–æ–∫—É –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏
    local offset = CFrame.new(0, 0, 5)
    myRoot.CFrame = targetRoot.CFrame * offset
    
    print("‚úÖ –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫ –∏–≥—Ä–æ–∫—É: " .. targetPlayer.Name)
end

-- –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
local function ResetCharacter()
    if player.Character then
        player.Character:BreakJoints()
        print("‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å–±—Ä–æ—à–µ–Ω!")
    end
end

-- –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä–∞
local function ServerHop()
    local placeId = game.PlaceId
    local servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. placeId .. "/servers/Public?sortOrder=Asc&limit=100"))
    
    for _, server in ipairs(servers.data) do
        if server.playing < server.maxPlayers and server.id ~= game.JobId then
            TeleportService:TeleportToPlaceInstance(placeId, server.id)
            return
        end
    end
    
    print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Å–µ—Ä–≤–µ—Ä!")
end

-- –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª–µ—Ç–∞
local function sFLY()
    local plr = player
    local char = plr.Character
    if not char then return end
    
    local humanoid = getHumanoid(char)
    if not humanoid then return end

    if flyKeyDown or flyKeyUp then
        flyKeyDown:Disconnect()
        flyKeyUp:Disconnect()
    end

    local T = getRoot(char)
    if not T then return end
   
    local CONTROL = {F = 0, B = 0, L = 0, R = 0, Q = 0, E = 0}
    local lCONTROL = {F = 0, B = 0, L = 0, R = 0, Q = 0, E = 0}
    local SPEED = 0

    local function FLY()
        FLYING = true
        local BG = Instance.new('BodyGyro')
        local BV = Instance.new('BodyVelocity')
      
        BG.P = 9e4
        BG.Parent = T
        BV.Parent = T
        BG.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
        BG.CFrame = T.CFrame
        BV.Velocity = Vector3.new(0, 0, 0)
        BV.MaxForce = Vector3.new(9e9, 9e9, 9e9)
        
        spawn(function()
            repeat wait()
 
                if not FLYING or not char or not T then break end
                
                local camera = workspace.CurrentCamera
                if humanoid then
                    humanoid.PlatformStand = true
                end

                if CONTROL.L + CONTROL.R ~= 0 or CONTROL.F + CONTROL.B ~= 0 or CONTROL.Q + CONTROL.E ~= 0 then
                    SPEED = 50 * FlySpeed
                elseif not (CONTROL.L + CONTROL.R ~= 0 or CONTROL.F + CONTROL.B ~= 0 or CONTROL.Q + CONTROL.E ~= 0) and SPEED ~= 0 then
                    SPEED = 0
                end
                
                if (CONTROL.L + CONTROL.R) ~= 0 or (CONTROL.F + CONTROL.B) ~= 0 or (CONTROL.Q + CONTROL.E) ~= 0 then
                    BV.Velocity = ((camera.CFrame.LookVector * (CONTROL.F + CONTROL.B)) + ((camera.CFrame * CFrame.new(CONTROL.L + CONTROL.R, (CONTROL.F + CONTROL.B + CONTROL.Q + CONTROL.E) * 0.2, 0).p) - camera.CFrame.p)) * SPEED
                    lCONTROL = {F = CONTROL.F, B = CONTROL.B, L = CONTROL.L, R = CONTROL.R}
                elseif (CONTROL.L + CONTROL.R) == 0 and (CONTROL.F + CONTROL.B) == 0 and (CONTROL.Q + CONTROL.E) == 0 and SPEED ~= 0 then
                    BV.Velocity = ((camera.CFrame.LookVector * (lCONTROL.F + lCONTROL.B)) + ((camera.CFrame * CFrame.new(lCONTROL.L + lCONTROL.R, (lCONTROL.F + lCONTROL.B + CONTROL.Q + CONTROL.E) * 0.2, 0).p) - camera.CFrame.p)) * SPEED
                else
                   BV.Velocity = Vector3.new(0, 0, 0)
                end
                BG.CFrame = camera.CFrame
            until not FLYING
            
            CONTROL = {F = 0, B = 0, L = 0, R = 0, Q = 0, E = 0}
    
            lCONTROL = {F = 0, B = 0, L = 0, R = 0, Q = 0, E = 0}
            SPEED = 0
            
            if BG then BG:Destroy() end
            if BV then BV:Destroy() end

            if humanoid and char.Parent then 
                humanoid.PlatformStand = false 
            end
        end)
    end

    flyKeyDown = UIS.InputBegan:Connect(function(input, processed)
        if processed then return end
        
        if input.KeyCode == Enum.KeyCode.W then
            CONTROL.F = FlySpeed
  
        elseif input.KeyCode == Enum.KeyCode.S then
            CONTROL.B = -FlySpeed
        elseif input.KeyCode == Enum.KeyCode.A then
            CONTROL.L = -FlySpeed
        elseif input.KeyCode == Enum.KeyCode.D then
            CONTROL.R = FlySpeed
        elseif input.KeyCode == Enum.KeyCode.E and QEfly then
          
            CONTROL.Q = FlySpeed * 2
        elseif input.KeyCode == Enum.KeyCode.Q and QEfly then
            CONTROL.E = -FlySpeed * 2
        end
    end)

    flyKeyUp = UIS.InputEnded:Connect(function(input, processed)
        if processed then return end
        
        if input.KeyCode == Enum.KeyCode.W then
            CONTROL.F = 0
        elseif input.KeyCode == Enum.KeyCode.S then
            CONTROL.B = 0
        elseif input.KeyCode == Enum.KeyCode.A then
            CONTROL.L = 0
        elseif input.KeyCode == Enum.KeyCode.D then
            CONTROL.R = 0
        elseif input.KeyCode == Enum.KeyCode.E then
         
            CONTROL.Q = 0
        elseif input.KeyCode == Enum.KeyCode.Q then
            CONTROL.E = 0
        end
    end)
    
    FLY()
end

local function NOFLY()
    FLYING = false
    if flyKeyDown then 
        flyKeyDown:Disconnect() 
        flyKeyDown = nil
    end
    if flyKeyUp then 
    
        flyKeyUp:Disconnect() 
        flyKeyUp = nil
    end
    
    if player.Character and player.Character:FindFirstChildOfClass('Humanoid') then
        player.Character:FindFirstChildOfClass('Humanoid').PlatformStand = false
    end
end

-- –§—É–Ω–∫—Ü–∏–∏ GUI
local function AddIgnoreEntry(playerName)
    local entry = Instance.new("TextButton")
    entry.Name = "Entry"
    entry.Parent = IgnoreList
    entry.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    entry.BorderSizePixel = 0
    entry.Size = UDim2.new(1, 0, 0, 25)
    entry.Font = Enum.Font.Gotham
   
    entry.Text = "‚úó " .. playerName
    entry.TextColor3 = Color3.fromRGB(255, 150, 150)
    entry.TextSize = 12
    entry.TextXAlignment = Enum.TextXAlignment.Left
    
    -- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–≥–Ω–æ—Ä–∞
    local entryCorner = Instance.new("UICorner")
    entryCorner.CornerRadius = UDim.new(0, 4)
    entryCorner.Parent = entry
    
    entry.MouseButton1Click:Connect(function()
        for i, name in ipairs(IgnoredPlayers) do
            if name == playerName then
     
                table.remove(IgnoredPlayers, i)
                break
            end
        end
        entry:Destroy()
        IgnoreList.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y)
    end)
    
    IgnoreList.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y)
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤ –≤ —Å–ø–∏—Å–æ–∫ TP
local function UpdatePlayerList()
    -- –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
    for _, child in ipairs(PlayerListFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    -- –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∫—Ä–æ–º–µ —Å–µ–±—è
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then
            local entry = Instance.new("TextButton")
       
            entry.Name = plr.Name
            entry.Parent = PlayerListFrame
            entry.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
            entry.BorderSizePixel = 0
            entry.Size = UDim2.new(1, 0, 0, 25)
            entry.Font = Enum.Font.Gotham
            entry.Text = plr.DisplayName .. " | @ " .. plr.Name
            entry.TextColor3 = Color3.fromRGB(200, 200, 255)
            entry.TextSize = 12
            entry.TextXAlignment = Enum.TextXAlignment.Left
            
            -- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
            local entryCorner = Instance.new("UICorner")
          
            entryCorner.CornerRadius = UDim.new(0, 4)
            entryCorner.Parent = entry
            
            entry.MouseButton1Click:Connect(function()
                selectedPlayerForTP = plr
                TPToPlayerButton.Text = "TP TO: " .. plr.DisplayName
                PlayerListFrame.Visible = false
            end)
        end
    end
    
    PlayerListFrame.CanvasSize = UDim2.new(0, 0, 0, PlayerListLayout.AbsoluteContentSize.Y)
end

local function IsPlayerIgnored(playerName)
    for _, ignoredName in ipairs(IgnoredPlayers) do
        if string.lower(ignoredName) == string.lower(playerName) then
            return true
        end
    end
    return false
end

-- –§–ª–∏–Ω–≥ –∏–≥—Ä–æ–∫–∞
local function FlingPlayer(targetPlayer)
    
    if not targetPlayer or targetPlayer == player or not targetPlayer.Character then
        return
    end
    
    local targetRoot = getRoot(targetPlayer.Character)
    if not targetRoot then return end
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—É–ª–¥–∞—É–Ω
    if lastFlingTime[targetPlayer] and tick() - lastFlingTime[targetPlayer] < 1 then
        return
    end
    
    lastFlingTime[targetPlayer] = tick()
    
    -- –ü—Ä–∏–º–µ–Ω—è–µ–º –º–æ—â–Ω—ã–π —Ñ–ª–∏–Ω–≥
   
    local flingPower = 50000
    
    -- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ BodyVelocity –∏ BodyAngularVelocity
    for _, v in ipairs(targetRoot:GetChildren()) do
        if v:IsA("BodyVelocity") or v:IsA("BodyAngularVelocity") then
            v:Destroy()
        end
    end
    
    -- –°–æ–∑–¥–∞–µ–º BodyVelocity –¥–ª—è —Å–∏–ª—å–Ω–æ–≥–æ —Ç–æ–ª—á–∫–∞
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.Velocity = Vector3.new(
        math.random(-flingPower, flingPower),
   
        math.random(flingPower, flingPower * 1.5),
        math.random(-flingPower, flingPower)
    )
    bodyVelocity.MaxForce = Vector3.new(100000, 100000, 100000)
    bodyVelocity.Parent = targetRoot
    
    -- –°–æ–∑–¥–∞–µ–º BodyAngularVelocity –¥–ª—è –≤—Ä–∞—â–µ–Ω–∏—è
    local bodyAngularVelocity = Instance.new("BodyAngularVelocity")
    bodyAngularVelocity.AngularVelocity = Vector3.new(
        math.random(-100000, 100000),
        math.random(-100000, 100000),
        math.random(-100000, 100000)
    )
    bodyAngularVelocity.MaxTorque = Vector3.new(100000, 100000, 100000)
 
    bodyAngularVelocity.Parent = targetRoot
    
    -- –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥—ã
    game:GetService("Debris"):AddItem(bodyVelocity, 0.5)
    game:GetService("Debris"):AddItem(bodyAngularVelocity, 0.5)
end

-- –§–ª–∏–Ω–≥ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
local function FlingAllPlayers()
    if isFlinging then 
        print("‚ùå –§–ª–∏–Ω–≥ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è!")
        return 
    end
    
    if not player.Character then 
        print("‚ùå –ù–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞!")
        return 
 
    end
    
    local rootPart = getRoot(player.Character)
    if not rootPart then 
        print("‚ùå –ù–µ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π —á–∞—Å—Ç–∏!")
        return 
    end
    
    isFlinging = true
    FlingButton.Text = "–§–õ–ò–ù–ì... –í–ö–õ"
    FlingButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
    
    -- –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –î–û –Ω–∞—á–∞–ª–∞ —Ñ–ª–∏–Ω–≥–∞
    originalFlingPosition = rootPart.CFrame
    local wasNoclip = Noclip
   
    local wasFlying = FLYING
    
    print("üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ñ–ª–∏–Ω–≥ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤...")
    
    spawn(function()
        -- –í–∫–ª—é—á–∞–µ–º –Ω–æ–∫–ª–∏–ø, –µ—Å–ª–∏ –æ–Ω –≤—ã–∫–ª—é—á–µ–Ω
        if not Noclip then
            ToggleNoclip()
        end
        
        -- –í–∫–ª—é—á–∞–µ–º –ø–æ–ª–µ—Ç, –µ—Å–ª–∏ –æ–Ω –≤—ã–∫–ª—é—á–µ–Ω
        if not FLYING then
            ToggleFly()
        end
        
        wait(0.5) -- –ñ–¥–µ–º –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–ª–µ—Ç–∞ –∏ –Ω–æ–∫–ª–∏–ø–∞
        
        local playersToFling = {}
        for _, targetPlayer in ipairs(Players:GetPlayers()) do
            if targetPlayer ~= player and not IsPlayerIgnored(targetPlayer.Name) and targetPlayer.Character then
          
                table.insert(playersToFling, targetPlayer)
            end
        end
        
        print("üéØ –¶–µ–ª–µ–π –¥–ª—è —Ñ–ª–∏–Ω–≥–∞: " .. #playersToFling)
        
        -- –§–ª–∏–Ω–≥–∞–µ–º –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞
        for i, targetPlayer in ipairs(playersToFling) do
            if not targetPlayer.Character then continue end
            
            local targetRoot = getRoot(targetPlayer.Character)
            if not targetRoot then continue end
            
            -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º—Å—è –∫ –∏–≥—Ä–æ–∫—É (–Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ)
            local targetPos = targetRoot.Position
         
            rootPart.CFrame = CFrame.new(targetPos + Vector3.new(0, 3, 0))
            
            -- –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–ª–∏–Ω–≥
            FlingPlayer(targetPlayer)
            print("üí• –§–ª–∏–Ω–≥–Ω—É—Ç: " .. targetPlayer.Name .. " (" .. i .. "/" .. #playersToFling .. ")")
            
            -- –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –º–µ–∂–¥—É —Ñ–ª–∏–Ω–≥–∞–º–∏
            wait(0.2)
        end
        
        -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
        if originalFlingPosition then
            rootPart.CFrame = originalFlingPosition
            print("üìç –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é –ø–æ–∑–∏—Ü–∏—é")
        end
        
  
        -- –í—ã–∫–ª—é—á–∞–µ–º –ø–æ–ª–µ—Ç, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
        if not wasFlying then
            ToggleFly()
        end
        
        -- –í—ã–∫–ª—é—á–∞–µ–º –Ω–æ–∫–ª–∏–ø, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
        if not wasNoclip then
            ToggleNoclip()
        end
  
        
        isFlinging = false
        FlingButton.Text = "–§–õ–ò–ù–ì –í–°–ï–•"
        FlingButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        
        print("‚úÖ –§–ª–∏–Ω–≥ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω!")
    end)
end

-- –°–∏—Å—Ç–µ–º–∞ Fly Fling
local function ToggleFlyFling()
    flyFlingEnabled = not flyFlingEnabled
    
    if flyFlingEnabled then
        print("üîÑ –í–∫–ª—é—á–∞–µ–º Fly Fling...")
  
        
        -- –í–∫–ª—é—á–∞–µ–º –ø–æ–ª–µ—Ç –∏ –Ω–æ–∫–ª–∏–ø
        if not FLYING then
            ToggleFly()
        end
        if not Noclip then
            ToggleNoclip()
        end
        
        FlyFlingButton.Text = "FLY FLING: –í–ö–õ"
        FlyFlingButton.BackgroundColor3 = Color3.fromRGB(200, 0, 200)
        
        -- –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
        flyFlingConnection = RunService.Heartbeat:Connect(function()
            if not flyFlingEnabled or not player.Character then return end
            
            local character = player.Character
            
            local myRoot = getRoot(character)
            if not myRoot then return end
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ —Ä—è–¥–æ–º
            for _, targetPlayer in ipairs(Players:GetPlayers()) do
                if targetPlayer ~= player and not IsPlayerIgnored(targetPlayer.Name) and targetPlayer.Character then
          
                    local targetRoot = getRoot(targetPlayer.Character)
                    if targetRoot then
                        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–±–ª–∏–∑–∫–æ–µ)
                        local distance = (myRoot.Position - targetRoot.Position).Magnitude
         
                        if distance < 10 then -- –£–º–µ–Ω—å—à–∏–ª –¥–∏—Å—Ç–∞–Ω—Ü–∏—é –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
                            FlingPlayer(targetPlayer)
                        end
                    end
   
                end
            end
        end)
        
        print("‚úÖ Fly Fling –≤–∫–ª—é—á–µ–Ω! –õ–µ—Ç–∞–π—Ç–µ –∏ —Ñ–ª–∏–Ω–≥–∞–π—Ç–µ –≤—Å–µ—Ö –Ω–∞ —Å–≤–æ–µ–º –ø—É—Ç–∏!")
    else
        -- –í—ã–∫–ª—é—á–∞–µ–º
        if flyFlingConnection then
            flyFlingConnection:Disconnect()
            flyFlingConnection = nil
        end
        
        FlyFlingButton.Text = "FLY FLING: –í–´–ö–õ"
        FlyFlingButton.BackgroundColor3 = Color3.fromRGB(150, 0, 150)
     
        print("‚ùå Fly Fling –≤—ã–∫–ª—é—á–µ–Ω")
    end
end

-- –°–∏—Å—Ç–µ–º–∞ Walk Fling
local function ToggleWalkFling()
    walkFlingEnabled = not walkFlingEnabled
    
    if walkFlingEnabled then
        WalkFlingButton.Text = "WALK FLING: –í–ö–õ"
        WalkFlingButton.BackgroundColor3 = Color3.fromRGB(255, 150, 0)
        
        -- –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Ä–∞—â–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
        walkFlingConnection = RunService.Heartbeat:Connect(function()
    
            if not walkFlingEnabled or not player.Character then return end
            
            local character = player.Character
            local myRoot = getRoot(character)
            if not myRoot then return end
            
            -- –í—Ä–∞—â–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–±–æ–ª–µ–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ)
            myRoot.RotVelocity = Vector3.new(0, 50, 0)
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ —Ä—è–¥–æ–º
            for _, targetPlayer in ipairs(Players:GetPlayers()) do
                if targetPlayer ~= player and not IsPlayerIgnored(targetPlayer.Name) and targetPlayer.Character then
          
                    local targetRoot = getRoot(targetPlayer.Character)
                    if targetRoot then
                        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
                        local distance = (myRoot.Position - targetRoot.Position).Magnitude
          
                        if distance < 8 then
                            FlingPlayer(targetPlayer)
                        end
                    end
          
                end
            end
        end)
        
        print("Walk Fling –≤–∫–ª—é—á–µ–Ω! –ò–¥–∏—Ç–µ –∏ —Ñ–ª–∏–Ω–≥–∞–π—Ç–µ –≤—Å–µ—Ö –Ω–∞ —Å–≤–æ–µ–º –ø—É—Ç–∏!")
    else
        -- –í—ã–∫–ª—é—á–∞–µ–º
        if walkFlingConnection then
            walkFlingConnection:Disconnect()
            walkFlingConnection = nil
        end
        
        -- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–∞—â–µ–Ω–∏–µ
        if player.Character then
         
            local myRoot = getRoot(player.Character)
            if myRoot then
                myRoot.RotVelocity = Vector3.new(0, 0, 0)
            end
        end
        
        WalkFlingButton.Text = "WALK FLING: –í–´–ö–õ"
        WalkFlingButton.BackgroundColor3 = Color3.fromRGB(200, 100, 0)
        
        print("Walk Fling –≤—ã–∫–ª—é—á–µ–Ω")
    end
end

-- –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–µ—Ç–∞
local function ToggleFly()
    if FLYING then
        NOFLY()
        FlyButton.Text = "–ü–û–õ–ï–¢: –í–´–ö–õ"
        FlyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 50)
        print("‚ùå –ü–æ–ª–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω")
    else
        sFLY()
        if FLYING then  -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª–µ—Ç —É—Å–ø–µ—à–Ω–æ –≤–∫–ª—é—á–∏–ª—Å—è
      
            FlyButton.Text = "–ü–û–õ–ï–¢: –í–ö–õ"
            FlyButton.BackgroundColor3 = Color3.fromRGB(50, 200, 100)
            print("‚úÖ –ü–æ–ª–µ—Ç –≤–∫–ª—é—á–µ–Ω!")
        else
            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å –ø–æ–ª–µ—Ç!")
        end
    end
end

-- –§—É–Ω–∫—Ü–∏—è –Ω–æ—É–∫–ª–∏–ø–∞
local NoclipConnection
local function ToggleNoclip()
    Noclip = not Noclip
    NoclipButton.Text = Noclip and "–ù–û–£–ö–õ–ò–ü: –í–ö–õ" or "–ù–û–£–ö–õ–ò–ü: –í–´–ö–õ"
 
    NoclipButton.BackgroundColor3 = Noclip and Color3.fromRGB(200, 200, 50) or Color3.fromRGB(150, 150, 0)
    
    if Noclip then
        NoclipConnection = RunService.Stepped:Connect(function()
            if not Noclip then return end
            if player.Character then
                for _, part in ipairs(player.Character:GetDescendants()) do
               
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
        print("‚úÖ –ù–æ–∫–ª–∏–ø –≤–∫–ª—é—á–µ–Ω")
 
    else
        if NoclipConnection then
            NoclipConnection:Disconnect()
            NoclipConnection = nil
        end
        if player.Character then
            for _, part in ipairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") then
        
                    part.CanCollide = true
                end
            end
        end
        print("‚ùå –ù–æ–∫–ª–∏–ø –≤—ã–∫–ª—é—á–µ–Ω")
    end
end

-- –§—É–Ω–∫—Ü–∏—è —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è GUI
local function ToggleMinimize()
    isMinimized = not isMinimized
    
    if isMinimized then
        -- –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è (–≤—Å–µ –∫—Ä–æ–º–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
        local elementsToHide = {
            InputFrame, IgnoreLabel, IgnoreList, FlingButton, FlyButton, 
            NoclipButton, FlyFlingButton, WalkFlingButton, TPForwardButton, 
            TPToPlayerButton, ResetButton, ServerHopButton, SpeedFrame, 
            WalkSpeedFrame, JumpPowerFrame, PlayerListFrame
        }
        
      
        -- –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        for _, element in ipairs(elementsToHide) do
            if element then
                element.Visible = false
            end
        end
        
        -- –ú–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä –∏ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
        MainFrame.Size = UDim2.new(0, 350, 0, 40)
        MinimizeButton.Text = "+"
        
        print("üì± GUI —Å–≤–µ—Ä–Ω—É—Ç")
    else
        -- –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–∫–∞–∑–∞
        local elementsToShow = {
            InputFrame, IgnoreLabel, IgnoreList, FlingButton, FlyButton, 
            NoclipButton, FlyFlingButton, WalkFlingButton, TPForwardButton, 
       
            TPToPlayerButton, ResetButton, ServerHopButton, SpeedFrame, 
            WalkSpeedFrame, JumpPowerFrame
        }
        
        -- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (PlayerListFrame –æ—Å—Ç–∞–µ—Ç—Å—è —Å–∫—Ä—ã—Ç—ã–º)
        for _, element in ipairs(elementsToShow) do
            if element then
                element.Visible = true
  
            end
        end
        
        -- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
        MainFrame.Size = UDim2.new(0, 350, 0, 750)
        MinimizeButton.Text = "-"
        
        print("üì± GUI —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç")
    end
end

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
AddButton.MouseButton1Click:Connect(function()
    local targetName = InputBox.Text
    if targetName ~= "" then
        local alreadyExists = false
        for _, name in ipairs(IgnoredPlayers) do
            if string.lower(name) == string.lower(targetName) then
                alreadyExists = true
                break
            end
        end
     
        
        if not alreadyExists then
            table.insert(IgnoredPlayers, targetName)
            AddIgnoreEntry(targetName)
            InputBox.Text = ""
            print("‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤ –∏–≥–Ω–æ—Ä: " .. targetName)
        else
            print("‚ùå –£–∂–µ –≤ –∏–≥–Ω–æ—Ä-–ª–∏—Å—Ç–µ: " .. targetName)
   
        end
    end
end)

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
FlingButton.MouseButton1Click:Connect(FlingAllPlayers)
FlyButton.MouseButton1Click:Connect(ToggleFly)
NoclipButton.MouseButton1Click:Connect(ToggleNoclip)
FlyFlingButton.MouseButton1Click:Connect(ToggleFlyFling)
WalkFlingButton.MouseButton1Click:Connect(ToggleWalkFling)
TPForwardButton.MouseButton1Click:Connect(TPForward)
TPToPlayerButton.MouseButton1Click:Connect(TPToPlayer)
ResetButton.MouseButton1Click:Connect(ResetCharacter)
ServerHopButton.MouseButton1Click:Connect(ServerHop)
MinimizeButton.MouseButton1Click:Connect(ToggleMinimize)

-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
TPToPlayerButton.MouseButton2Click:Connect(function() -- –ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ –º—ã—à–∏
    PlayerListFrame.Visible = not PlayerListFrame.Visible
    if PlayerListFrame.Visible then
        UpdatePlayerList()
        print("üìã –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –æ—Ç–∫—Ä—ã—Ç")
    else
        print("üìã –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –∑–∞–∫—Ä—ã—Ç")
    end
end)

-- –ö–Ω–æ–ø–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ–ª–µ—Ç–∞
SpeedFrame.DownButton.MouseButton1Click:Connect(function()
    FlySpeed = math.max(1, FlySpeed - 1)
    SpeedFrame.Label.Text = "Fly Speed: " .. tostring(FlySpeed)
    print("üìâ –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–ª–µ—Ç–∞: " .. FlySpeed)
end)

SpeedFrame.UpButton.MouseButton1Click:Connect(function()
    FlySpeed = math.min(10, FlySpeed + 1)
    SpeedFrame.Label.Text = "Fly Speed: " .. tostring(FlySpeed)
    print("üìà –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–ª–µ—Ç–∞: " .. FlySpeed)
end)

-- –ö–Ω–æ–ø–∫–∏ WalkSpeed
WalkSpeedFrame.DownButton.MouseButton1Click:Connect(function()
    currentWalkSpeed = math.max(0, currentWalkSpeed - 5)
    WalkSpeedFrame.Label.Text = "WalkSpeed: " .. tostring(currentWalkSpeed)
    updateWalkSpeed() -- –í—ã–∑—ã–≤–∞–µ–º –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è
    print("üìâ WalkSpeed: " .. currentWalkSpeed)
end)

WalkSpeedFrame.UpButton.MouseButton1Click:Connect(function()
    currentWalkSpeed = math.min(200, currentWalkSpeed + 5)
    WalkSpeedFrame.Label.Text = "WalkSpeed: " .. tostring(currentWalkSpeed)
    updateWalkSpeed() -- –í—ã–∑—ã–≤–∞–µ–º –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è
    print("üìà WalkSpeed: " .. currentWalkSpeed)
end)

-- –ö–Ω–æ–ø–∫–∏ JumpPower
JumpPowerFrame.DownButton.MouseButton1Click:Connect(function()
    currentJumpPower = math.max(0, currentJumpPower - 5)
    JumpPowerFrame.Label.Text = "JumpPower: " .. tostring(currentJumpPower)
    updateJumpPower()
    print("üìâ JumpPower: " .. currentJumpPower)
end)

JumpPowerFrame.UpButton.MouseButton1Click:Connect(function()
    currentJumpPower = math.min(200, currentJumpPower + 5)
    JumpPowerFrame.Label.Text = "JumpPower: " .. tostring(currentJumpPower)
    updateJumpPower()
    print("üìà JumpPower: " .. currentJumpPower)
end)

-- –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
spawn(function()
    wait(1)
    if player.Character then
        local humanoid = getHumanoid(player.Character)
        if humanoid then
            -- –ß–∏—Ç–∞–µ–º WalkSpeed –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∫ –±–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            currentWalkSpeed = humanoid.WalkSpeed
            originalWalkSpeed = currentWalkSpeed
            WalkSpeedFrame.Label.Text = "WalkSpeed: " .. tostring(currentWalkSpeed)
            
            currentJumpPower = humanoid.JumpPower
            originalJumpPower = currentJumpPower
            JumpPowerFrame.Label.Text = "JumpPower: " .. tostring(currentJumpPower)
      
            
            -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—å WalkSpeed
            updateWalkSpeed() 
            
            print("‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã")
        end
    end
end)

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Ä–µ—Å–ø–∞–≤–Ω–µ (–°–º–µ—Ä—Ç—å)
player.CharacterAdded:Connect(function(character)
    wait(0.5) -- –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã Humanoid —Ç–æ—á–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
    
    -- –ü–æ–ª—É—á–∞–µ–º Humanoid
    local humanoid = getHumanoid(character)
    if humanoid then
        -- –ü—Ä–∏ —Ä–µ—Å–ø–∞–≤–Ω–µ **–±–µ—Ä–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞**
        -- –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å 16 –∏–ª–∏ –ª—é–±—ã–º –¥—Ä—É–≥–∏–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∏–≥—Ä–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
        currentWalkSpeed = humanoid.WalkSpeed
        originalWalkSpeed = currentWalkSpeed
        WalkSpeedFrame.Label.Text = "WalkSpeed: " .. tostring(currentWalkSpeed)
        
        currentJumpPower = humanoid.JumpPower
        originalJumpPower = currentJumpPower
        JumpPowerFrame.Label.Text = "JumpPower: " .. tostring(currentJumpPower)
    end
    
    -- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—ã –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã
    if Noclip then
        ToggleNoclip()
        wait(0.1)
        ToggleNoclip()
    end
    
    if FLYING then
        ToggleFly()
        wait(0.1)
        ToggleFly()
    end
    
    if flyFlingEnabled then
        ToggleFlyFling()
        wait(0.1)
        ToggleFlyFling()
    end
    
    if walkFlingEnabled then
        ToggleWalkFling()
        wait(0.1)
        ToggleWalkFling()
    end
    
    -- –ü—Ä–∏–º–µ–Ω—è–µ–º WalkSpeed (–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)
    updateWalkSpeed()
    updateJumpPower()
    
    print("‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–∂ –∑–∞—Ä–µ—Å–ø–∞–≤–Ω–µ–Ω, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã")
end)

-- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
Players.PlayerRemoving:Connect(function(leftPlayer)
    lastFlingTime[leftPlayer] = nil
    if selectedPlayerForTP == leftPlayer then
        selectedPlayerForTP = nil
        TPToPlayerButton.Text = "TP TO PLAYER"
        print("‚ùå –ò–≥—Ä–æ–∫ –≤—ã—à–µ–ª: " .. leftPlayer.Name)
    end
end)

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏/–æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
Players.PlayerAdded:Connect(UpdatePlayerList)
Players.PlayerRemoving:Connect(UpdatePlayerList)

print("")
print("üéâ Xeno Script –∑–∞–≥—Ä—É–∂–µ–Ω!")
print("‚ö°Ô∏è WalkSpeed —Ç–µ–ø–µ—Ä—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –∏ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è!")
